<!doctype html>
<html>
<head>
  <title>Topology - overview</title>
  <script type="text/javascript" src="js/vis-network.min.js"></script>
  <link rel="stylesheet" href="w3.css">
  <script src="js/jquery.min.js"></script>
  <style type="text/css">
    #mynetwork {
      width: 600px;
      height: 400px;
      border: 1px solid lightgray;
    }
  </style>
</head>
<body>
<div id="x"></div>
<div id="mynetwork"></div>
<script type="text/javascript">


  var tempNodeArray = [];
  var tempConnectionArray = []

  $(document).ready(function () {
    $.get("http://192.168.1.101:8000/getAllNode", function(data, status){

      nodeDetails = data
      
      for(var node in nodeDetails){
        tempNodeArray.push({
          id: nodeDetails[node].nodeDetail.link_local_IPv6,
          label: nodeDetails[node].nodeDetail.IP,
          image: "iot.png",
          shape: "image"
        });

        for(var neighbor in nodeDetails[node].neighbors){
          
          var found = false;
          for(var chk in tempConnectionArray){
            if(tempConnectionArray[chk].to == nodeDetails[node].nodeDetail.link_local_IPv6) 
              found = true;
          }

          if(!found){
            tempConnectionArray.push({
              from: nodeDetails[node].nodeDetail.link_local_IPv6,
              to: neighbor,
              width: 3, length: 400
            });
          }

          console.log(tempConnectionArray)
        }
      }
      

      var nodes = new vis.DataSet(tempNodeArray);;

      var edges = new vis.DataSet(tempConnectionArray);

      // create a network
      var container = document.getElementById('mynetwork');
      var data = {
        nodes: nodes,
        edges: edges
      };
      var options = {};
      var network = new vis.Network(container, data, options);

    });
    
  });


</script>
</body>
</html>